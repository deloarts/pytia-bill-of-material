<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>pytia_bill_of_material.utils.files API documentation</title>
<meta name="description" content="File utility submodule." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pytia_bill_of_material.utils.files</code></h1>
</header>
<section id="section-intro">
<p>File utility submodule.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
    File utility submodule.
&#34;&#34;&#34;

import atexit
import os
import shutil
from pathlib import Path
from tkinter import messagebox as tkmsg
from typing import List, Optional

from models.files import FileUtilityDeleteModel, FileUtilityMoveModel
from pytia.log import log
from resources import resource


class FileUtility:
    &#34;&#34;&#34;
    The FileUtility class. Provides methods for deleting and moving files and some other
    useful file related functions.
    &#34;&#34;&#34;

    def __init__(self) -&gt; None:
        &#34;&#34;&#34;Inits the FileUtility class.&#34;&#34;&#34;
        self._delete_list: List[FileUtilityDeleteModel] = []
        self._move_list: List[FileUtilityMoveModel] = []

        atexit.register(self.delete_all_exit)

    @property
    def delete_items(self) -&gt; List[FileUtilityDeleteModel]:
        &#34;&#34;&#34;Returns a list of all files that should be deleted as FileUtilityDeleteModel.&#34;&#34;&#34;
        return self._delete_list

    @property
    def move_items(self) -&gt; List[FileUtilityMoveModel]:
        &#34;&#34;&#34;Returns a list of all files that should be moved as FileUtilityMoveModel.&#34;&#34;&#34;
        return self._move_list

    @property
    def all_moved(self) -&gt; bool:
        &#34;&#34;&#34;Returns True if all files have been moved.&#34;&#34;&#34;
        for item in self._move_list:
            if not item.moved:
                return False
        return True

    @property
    def all_deleted(self) -&gt; bool:
        &#34;&#34;&#34;Returns True if all files have been deleted.&#34;&#34;&#34;
        for item in self._delete_list:
            if not item.deleted:
                return False
        return True

    def delete_item(self, item: FileUtilityDeleteModel) -&gt; None:
        &#34;&#34;&#34;
        Deletes the given item from the list of delete-items.

        Args:
            item (FileUtilityDeleteModel): The file to delete.
        &#34;&#34;&#34;
        while os.path.exists(item.path) and not item.deleted and not item.skipped:
            try:
                os.remove(item.path)
                item.deleted = True
                log.info(f&#34;Deleted file at {str(item.path)!r}&#34;)
            except PermissionError:
                if item.ask_retry and not item.skip_silent:
                    if tkmsg.askretrycancel(
                        title=resource.settings.title,
                        message=(
                            f&#34;The file with the name {item.path.name!r} at the location &#34;
                            f&#34;{str(item.path)!r} cannot be deleted, because it is opened &#34;
                            &#34;by another user or process.\n\n&#34;
                            f&#34;Do you want to retry deleting this file?\n\n&#34;
                            f&#34;If you click &#39;Retry&#39; you have to make sure that the existing file &#34;
                            &#34;is not blocked by another user or process anymore.&#34;
                        ),
                    ):
                        continue

                elif not item.skip_silent:
                    tkmsg.showwarning(
                        title=resource.settings.title,
                        message=(
                            f&#34;The file with the name {item.path.name!r} at the location &#34;
                            f&#34;{str(item.path)!r} cannot be deleted, because it is opened &#34;
                            &#34;by another user or process.\n\n&#34;
                            &#34;Deleting this file will be skipped.&#34;
                        ),
                    )

                item.skipped = True
                log.warning(
                    f&#34;Skipped deleting file at {str(item.path)!r}: Not enough permission.&#34;
                )
                return

    def move_item(self, item: FileUtilityMoveModel) -&gt; None:
        &#34;&#34;&#34;
        Moves the given item from the list of move-items.

        Args:
            item (FileUtilityDeleteModel): The file to move.
        &#34;&#34;&#34;
        # TODO: Add option to move as &#39;file (new)&#39; if cannot be moved due to permission error.
        if not item.moved and not item.skipped:
            while os.path.exists(item.target):
                if item.delete_existing:
                    try:
                        os.remove(item.target)
                        log.info(f&#34;Deleted existing file at {str(item.target)!r}&#34;)
                        break
                    except PermissionError:
                        if item.ask_retry:
                            if tkmsg.askretrycancel(
                                title=resource.settings.title,
                                message=(
                                    f&#34;Cannot move file, because a file with the name &#34;
                                    f&#34;{item.target.name!r} already exists at {str(item.target.parent)!r}, &#34;
                                    &#34;but cannot be overwritten, because it is opened by another &#34;
                                    &#34;user or process.\n\n&#34;
                                    &#34;Do you want to retry moving file?\n\n&#34;
                                    &#34;If you click &#39;Retry&#39; you have to make sure that the &#34;
                                    &#34;existing file is not blocked by another user or &#34;
                                    &#34;process anymore.&#34;
                                ),
                            ):
                                continue
                item.skipped = True
                log.warning(
                    f&#34;Skipped moving file from {str(item.source)!r} to {str(item.target)!r}.&#34;
                    &#34;\n\nThe target file already exists and cannot be deleted, because it is &#34;
                    &#34;blocked by another user or process.&#34;
                )
                if item.delete_skipped:
                    os.remove(item.source)
                    log.info(f&#34;Deleted skipped file {str(item.source)!r}.&#34;)
                return

            shutil.move(item.source, item.target)
            item.moved = True
            log.info(f&#34;Moved file from {str(item.source)!r} to {str(item.target)!r}.&#34;)

    def add_delete(
        self,
        path: Path,
        ask_retry: bool = True,
        skip_silent: bool = False,
        at_exit: bool = False,
    ) -&gt; None:
        &#34;&#34;&#34;
        Adds a file to delete later.

        Args:
            path (Path): The path of the file to delete.
            ask_retry (bool, optional): The user will be asked for retrying if the file cannot be \
                deleted due to a permission error. Defaults to True.
            skip_silent (bool, optional): Skips without a user prompt if the file cannot be \
                deleted. Defaults to False.
            at_exit (bool, optional): Deletes the file only at application exit. Defaults to False.
        &#34;&#34;&#34;
        if not path.is_file():
            log.error(f&#34;Cannot delete file at {str(path)!r}: Not a file.&#34;)
            return

        item = FileUtilityDeleteModel(
            path=path, ask_retry=ask_retry, skip_silent=skip_silent, at_exit=at_exit
        )
        self._delete_list.append(item)

    def add_move(
        self,
        source: Path,
        target: Path,
        delete_existing: bool = True,
        ask_retry: bool = True,
        delete_skipped: bool = True,
    ) -&gt; None:
        &#34;&#34;&#34;
        Adds a file to move later.

        Args:
            source (Path): The path of the file to move.
            target (Path): The path where the file should be moved.
            delete_existing (bool, optional): An existing file at the target location will be \
                deleted before moving. Defaults to True.
            ask_retry (bool, optional): The user will be asked for retrying if the file at the \
                target location cannot be deleted due to a permission error. Defaults to True.
            delete_skipped (bool, optional): Deletes all skipped files at the source location. \
                Defaults to True.
        &#34;&#34;&#34;
        if not source.is_file():
            log.error(f&#34;Cannot move file at {str(source)!r}: Not a file.&#34;)
            return

        item = FileUtilityMoveModel(
            source=source,
            target=target,
            delete_existing=delete_existing,
            ask_retry=ask_retry,
            delete_skipped=delete_skipped,
        )
        self._move_list.append(item)

    def delete_all_exit(self) -&gt; None:
        &#34;&#34;&#34;Deletes all file, including those marked as &#39;delete at exit&#39;.&#34;&#34;&#34;
        for item in self._delete_list:
            self.delete_item(item)

    def delete_all(self) -&gt; None:
        &#34;&#34;&#34;Deletes all files, except those marked as &#39;delete at exit&#39;.&#34;&#34;&#34;
        for item in self._delete_list:
            if not item.at_exit:
                self.delete_item(item)

    def move_all(self) -&gt; None:
        &#34;&#34;&#34;Moves all files.&#34;&#34;&#34;
        for item in self._move_list:
            self.move_item(item)

    @staticmethod
    def get_random_filename(
        prefix: Optional[str] = None, filetype: Optional[str] = None
    ) -&gt; str:
        &#34;&#34;&#34;
        Returns a random filename.

        Args:
            prefix (Optional[str], optional): A prefix for the filename. Defaults to None.
            filetype (Optional[str], optional): The filetype. Defaults to None. Can be something \
                like `.xls` or `xls`. If set to `None` only a random name will be returned.

        Returns:
            str: A random filename as string.
        &#34;&#34;&#34;
        if filetype and not filetype.startswith(&#34;.&#34;):
            filetype = &#34;.&#34; + filetype
        if prefix is None:
            prefix = &#34;&#34;
        if filetype is None:
            filetype = &#34;&#34;

        return f&#34;{prefix}{os.urandom(24).hex()}{filetype}&#34;


file_utility = FileUtility()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pytia_bill_of_material.utils.files.FileUtility"><code class="flex name class">
<span>class <span class="ident">FileUtility</span></span>
</code></dt>
<dd>
<div class="desc"><p>The FileUtility class. Provides methods for deleting and moving files and some other
useful file related functions.</p>
<p>Inits the FileUtility class.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class FileUtility:
    &#34;&#34;&#34;
    The FileUtility class. Provides methods for deleting and moving files and some other
    useful file related functions.
    &#34;&#34;&#34;

    def __init__(self) -&gt; None:
        &#34;&#34;&#34;Inits the FileUtility class.&#34;&#34;&#34;
        self._delete_list: List[FileUtilityDeleteModel] = []
        self._move_list: List[FileUtilityMoveModel] = []

        atexit.register(self.delete_all_exit)

    @property
    def delete_items(self) -&gt; List[FileUtilityDeleteModel]:
        &#34;&#34;&#34;Returns a list of all files that should be deleted as FileUtilityDeleteModel.&#34;&#34;&#34;
        return self._delete_list

    @property
    def move_items(self) -&gt; List[FileUtilityMoveModel]:
        &#34;&#34;&#34;Returns a list of all files that should be moved as FileUtilityMoveModel.&#34;&#34;&#34;
        return self._move_list

    @property
    def all_moved(self) -&gt; bool:
        &#34;&#34;&#34;Returns True if all files have been moved.&#34;&#34;&#34;
        for item in self._move_list:
            if not item.moved:
                return False
        return True

    @property
    def all_deleted(self) -&gt; bool:
        &#34;&#34;&#34;Returns True if all files have been deleted.&#34;&#34;&#34;
        for item in self._delete_list:
            if not item.deleted:
                return False
        return True

    def delete_item(self, item: FileUtilityDeleteModel) -&gt; None:
        &#34;&#34;&#34;
        Deletes the given item from the list of delete-items.

        Args:
            item (FileUtilityDeleteModel): The file to delete.
        &#34;&#34;&#34;
        while os.path.exists(item.path) and not item.deleted and not item.skipped:
            try:
                os.remove(item.path)
                item.deleted = True
                log.info(f&#34;Deleted file at {str(item.path)!r}&#34;)
            except PermissionError:
                if item.ask_retry and not item.skip_silent:
                    if tkmsg.askretrycancel(
                        title=resource.settings.title,
                        message=(
                            f&#34;The file with the name {item.path.name!r} at the location &#34;
                            f&#34;{str(item.path)!r} cannot be deleted, because it is opened &#34;
                            &#34;by another user or process.\n\n&#34;
                            f&#34;Do you want to retry deleting this file?\n\n&#34;
                            f&#34;If you click &#39;Retry&#39; you have to make sure that the existing file &#34;
                            &#34;is not blocked by another user or process anymore.&#34;
                        ),
                    ):
                        continue

                elif not item.skip_silent:
                    tkmsg.showwarning(
                        title=resource.settings.title,
                        message=(
                            f&#34;The file with the name {item.path.name!r} at the location &#34;
                            f&#34;{str(item.path)!r} cannot be deleted, because it is opened &#34;
                            &#34;by another user or process.\n\n&#34;
                            &#34;Deleting this file will be skipped.&#34;
                        ),
                    )

                item.skipped = True
                log.warning(
                    f&#34;Skipped deleting file at {str(item.path)!r}: Not enough permission.&#34;
                )
                return

    def move_item(self, item: FileUtilityMoveModel) -&gt; None:
        &#34;&#34;&#34;
        Moves the given item from the list of move-items.

        Args:
            item (FileUtilityDeleteModel): The file to move.
        &#34;&#34;&#34;
        # TODO: Add option to move as &#39;file (new)&#39; if cannot be moved due to permission error.
        if not item.moved and not item.skipped:
            while os.path.exists(item.target):
                if item.delete_existing:
                    try:
                        os.remove(item.target)
                        log.info(f&#34;Deleted existing file at {str(item.target)!r}&#34;)
                        break
                    except PermissionError:
                        if item.ask_retry:
                            if tkmsg.askretrycancel(
                                title=resource.settings.title,
                                message=(
                                    f&#34;Cannot move file, because a file with the name &#34;
                                    f&#34;{item.target.name!r} already exists at {str(item.target.parent)!r}, &#34;
                                    &#34;but cannot be overwritten, because it is opened by another &#34;
                                    &#34;user or process.\n\n&#34;
                                    &#34;Do you want to retry moving file?\n\n&#34;
                                    &#34;If you click &#39;Retry&#39; you have to make sure that the &#34;
                                    &#34;existing file is not blocked by another user or &#34;
                                    &#34;process anymore.&#34;
                                ),
                            ):
                                continue
                item.skipped = True
                log.warning(
                    f&#34;Skipped moving file from {str(item.source)!r} to {str(item.target)!r}.&#34;
                    &#34;\n\nThe target file already exists and cannot be deleted, because it is &#34;
                    &#34;blocked by another user or process.&#34;
                )
                if item.delete_skipped:
                    os.remove(item.source)
                    log.info(f&#34;Deleted skipped file {str(item.source)!r}.&#34;)
                return

            shutil.move(item.source, item.target)
            item.moved = True
            log.info(f&#34;Moved file from {str(item.source)!r} to {str(item.target)!r}.&#34;)

    def add_delete(
        self,
        path: Path,
        ask_retry: bool = True,
        skip_silent: bool = False,
        at_exit: bool = False,
    ) -&gt; None:
        &#34;&#34;&#34;
        Adds a file to delete later.

        Args:
            path (Path): The path of the file to delete.
            ask_retry (bool, optional): The user will be asked for retrying if the file cannot be \
                deleted due to a permission error. Defaults to True.
            skip_silent (bool, optional): Skips without a user prompt if the file cannot be \
                deleted. Defaults to False.
            at_exit (bool, optional): Deletes the file only at application exit. Defaults to False.
        &#34;&#34;&#34;
        if not path.is_file():
            log.error(f&#34;Cannot delete file at {str(path)!r}: Not a file.&#34;)
            return

        item = FileUtilityDeleteModel(
            path=path, ask_retry=ask_retry, skip_silent=skip_silent, at_exit=at_exit
        )
        self._delete_list.append(item)

    def add_move(
        self,
        source: Path,
        target: Path,
        delete_existing: bool = True,
        ask_retry: bool = True,
        delete_skipped: bool = True,
    ) -&gt; None:
        &#34;&#34;&#34;
        Adds a file to move later.

        Args:
            source (Path): The path of the file to move.
            target (Path): The path where the file should be moved.
            delete_existing (bool, optional): An existing file at the target location will be \
                deleted before moving. Defaults to True.
            ask_retry (bool, optional): The user will be asked for retrying if the file at the \
                target location cannot be deleted due to a permission error. Defaults to True.
            delete_skipped (bool, optional): Deletes all skipped files at the source location. \
                Defaults to True.
        &#34;&#34;&#34;
        if not source.is_file():
            log.error(f&#34;Cannot move file at {str(source)!r}: Not a file.&#34;)
            return

        item = FileUtilityMoveModel(
            source=source,
            target=target,
            delete_existing=delete_existing,
            ask_retry=ask_retry,
            delete_skipped=delete_skipped,
        )
        self._move_list.append(item)

    def delete_all_exit(self) -&gt; None:
        &#34;&#34;&#34;Deletes all file, including those marked as &#39;delete at exit&#39;.&#34;&#34;&#34;
        for item in self._delete_list:
            self.delete_item(item)

    def delete_all(self) -&gt; None:
        &#34;&#34;&#34;Deletes all files, except those marked as &#39;delete at exit&#39;.&#34;&#34;&#34;
        for item in self._delete_list:
            if not item.at_exit:
                self.delete_item(item)

    def move_all(self) -&gt; None:
        &#34;&#34;&#34;Moves all files.&#34;&#34;&#34;
        for item in self._move_list:
            self.move_item(item)

    @staticmethod
    def get_random_filename(
        prefix: Optional[str] = None, filetype: Optional[str] = None
    ) -&gt; str:
        &#34;&#34;&#34;
        Returns a random filename.

        Args:
            prefix (Optional[str], optional): A prefix for the filename. Defaults to None.
            filetype (Optional[str], optional): The filetype. Defaults to None. Can be something \
                like `.xls` or `xls`. If set to `None` only a random name will be returned.

        Returns:
            str: A random filename as string.
        &#34;&#34;&#34;
        if filetype and not filetype.startswith(&#34;.&#34;):
            filetype = &#34;.&#34; + filetype
        if prefix is None:
            prefix = &#34;&#34;
        if filetype is None:
            filetype = &#34;&#34;

        return f&#34;{prefix}{os.urandom(24).hex()}{filetype}&#34;</code></pre>
</details>
<h3>Static methods</h3>
<dl>
<dt id="pytia_bill_of_material.utils.files.FileUtility.get_random_filename"><code class="name flex">
<span>def <span class="ident">get_random_filename</span></span>(<span>prefix: str | None = None, filetype: str | None = None) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a random filename.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>prefix</code></strong> :&ensp;<code>Optional[str]</code>, optional</dt>
<dd>A prefix for the filename. Defaults to None.</dd>
<dt><strong><code>filetype</code></strong> :&ensp;<code>Optional[str]</code>, optional</dt>
<dd>The filetype. Defaults to None. Can be something
like <code>.xls</code> or <code>xls</code>. If set to <code>None</code> only a random name will be returned.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>A random filename as string.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def get_random_filename(
    prefix: Optional[str] = None, filetype: Optional[str] = None
) -&gt; str:
    &#34;&#34;&#34;
    Returns a random filename.

    Args:
        prefix (Optional[str], optional): A prefix for the filename. Defaults to None.
        filetype (Optional[str], optional): The filetype. Defaults to None. Can be something \
            like `.xls` or `xls`. If set to `None` only a random name will be returned.

    Returns:
        str: A random filename as string.
    &#34;&#34;&#34;
    if filetype and not filetype.startswith(&#34;.&#34;):
        filetype = &#34;.&#34; + filetype
    if prefix is None:
        prefix = &#34;&#34;
    if filetype is None:
        filetype = &#34;&#34;

    return f&#34;{prefix}{os.urandom(24).hex()}{filetype}&#34;</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="pytia_bill_of_material.utils.files.FileUtility.all_deleted"><code class="name">var <span class="ident">all_deleted</span> : bool</code></dt>
<dd>
<div class="desc"><p>Returns True if all files have been deleted.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def all_deleted(self) -&gt; bool:
    &#34;&#34;&#34;Returns True if all files have been deleted.&#34;&#34;&#34;
    for item in self._delete_list:
        if not item.deleted:
            return False
    return True</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.files.FileUtility.all_moved"><code class="name">var <span class="ident">all_moved</span> : bool</code></dt>
<dd>
<div class="desc"><p>Returns True if all files have been moved.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def all_moved(self) -&gt; bool:
    &#34;&#34;&#34;Returns True if all files have been moved.&#34;&#34;&#34;
    for item in self._move_list:
        if not item.moved:
            return False
    return True</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.files.FileUtility.delete_items"><code class="name">var <span class="ident">delete_items</span> : List[models.files.FileUtilityDeleteModel]</code></dt>
<dd>
<div class="desc"><p>Returns a list of all files that should be deleted as FileUtilityDeleteModel.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def delete_items(self) -&gt; List[FileUtilityDeleteModel]:
    &#34;&#34;&#34;Returns a list of all files that should be deleted as FileUtilityDeleteModel.&#34;&#34;&#34;
    return self._delete_list</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.files.FileUtility.move_items"><code class="name">var <span class="ident">move_items</span> : List[models.files.FileUtilityMoveModel]</code></dt>
<dd>
<div class="desc"><p>Returns a list of all files that should be moved as FileUtilityMoveModel.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def move_items(self) -&gt; List[FileUtilityMoveModel]:
    &#34;&#34;&#34;Returns a list of all files that should be moved as FileUtilityMoveModel.&#34;&#34;&#34;
    return self._move_list</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pytia_bill_of_material.utils.files.FileUtility.add_delete"><code class="name flex">
<span>def <span class="ident">add_delete</span></span>(<span>self, path: pathlib.Path, ask_retry: bool = True, skip_silent: bool = False, at_exit: bool = False) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Adds a file to delete later.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>path</code></strong> :&ensp;<code>Path</code></dt>
<dd>The path of the file to delete.</dd>
<dt><strong><code>ask_retry</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>The user will be asked for retrying if the file cannot be
deleted due to a permission error. Defaults to True.</dd>
<dt><strong><code>skip_silent</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Skips without a user prompt if the file cannot be
deleted. Defaults to False.</dd>
<dt><strong><code>at_exit</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Deletes the file only at application exit. Defaults to False.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_delete(
    self,
    path: Path,
    ask_retry: bool = True,
    skip_silent: bool = False,
    at_exit: bool = False,
) -&gt; None:
    &#34;&#34;&#34;
    Adds a file to delete later.

    Args:
        path (Path): The path of the file to delete.
        ask_retry (bool, optional): The user will be asked for retrying if the file cannot be \
            deleted due to a permission error. Defaults to True.
        skip_silent (bool, optional): Skips without a user prompt if the file cannot be \
            deleted. Defaults to False.
        at_exit (bool, optional): Deletes the file only at application exit. Defaults to False.
    &#34;&#34;&#34;
    if not path.is_file():
        log.error(f&#34;Cannot delete file at {str(path)!r}: Not a file.&#34;)
        return

    item = FileUtilityDeleteModel(
        path=path, ask_retry=ask_retry, skip_silent=skip_silent, at_exit=at_exit
    )
    self._delete_list.append(item)</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.files.FileUtility.add_move"><code class="name flex">
<span>def <span class="ident">add_move</span></span>(<span>self, source: pathlib.Path, target: pathlib.Path, delete_existing: bool = True, ask_retry: bool = True, delete_skipped: bool = True) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Adds a file to move later.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>source</code></strong> :&ensp;<code>Path</code></dt>
<dd>The path of the file to move.</dd>
<dt><strong><code>target</code></strong> :&ensp;<code>Path</code></dt>
<dd>The path where the file should be moved.</dd>
<dt><strong><code>delete_existing</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>An existing file at the target location will be
deleted before moving. Defaults to True.</dd>
<dt><strong><code>ask_retry</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>The user will be asked for retrying if the file at the
target location cannot be deleted due to a permission error. Defaults to True.</dd>
<dt><strong><code>delete_skipped</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Deletes all skipped files at the source location.
Defaults to True.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_move(
    self,
    source: Path,
    target: Path,
    delete_existing: bool = True,
    ask_retry: bool = True,
    delete_skipped: bool = True,
) -&gt; None:
    &#34;&#34;&#34;
    Adds a file to move later.

    Args:
        source (Path): The path of the file to move.
        target (Path): The path where the file should be moved.
        delete_existing (bool, optional): An existing file at the target location will be \
            deleted before moving. Defaults to True.
        ask_retry (bool, optional): The user will be asked for retrying if the file at the \
            target location cannot be deleted due to a permission error. Defaults to True.
        delete_skipped (bool, optional): Deletes all skipped files at the source location. \
            Defaults to True.
    &#34;&#34;&#34;
    if not source.is_file():
        log.error(f&#34;Cannot move file at {str(source)!r}: Not a file.&#34;)
        return

    item = FileUtilityMoveModel(
        source=source,
        target=target,
        delete_existing=delete_existing,
        ask_retry=ask_retry,
        delete_skipped=delete_skipped,
    )
    self._move_list.append(item)</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.files.FileUtility.delete_all"><code class="name flex">
<span>def <span class="ident">delete_all</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Deletes all files, except those marked as 'delete at exit'.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_all(self) -&gt; None:
    &#34;&#34;&#34;Deletes all files, except those marked as &#39;delete at exit&#39;.&#34;&#34;&#34;
    for item in self._delete_list:
        if not item.at_exit:
            self.delete_item(item)</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.files.FileUtility.delete_all_exit"><code class="name flex">
<span>def <span class="ident">delete_all_exit</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Deletes all file, including those marked as 'delete at exit'.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_all_exit(self) -&gt; None:
    &#34;&#34;&#34;Deletes all file, including those marked as &#39;delete at exit&#39;.&#34;&#34;&#34;
    for item in self._delete_list:
        self.delete_item(item)</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.files.FileUtility.delete_item"><code class="name flex">
<span>def <span class="ident">delete_item</span></span>(<span>self, item: models.files.FileUtilityDeleteModel) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Deletes the given item from the list of delete-items.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>item</code></strong> :&ensp;<code>FileUtilityDeleteModel</code></dt>
<dd>The file to delete.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_item(self, item: FileUtilityDeleteModel) -&gt; None:
    &#34;&#34;&#34;
    Deletes the given item from the list of delete-items.

    Args:
        item (FileUtilityDeleteModel): The file to delete.
    &#34;&#34;&#34;
    while os.path.exists(item.path) and not item.deleted and not item.skipped:
        try:
            os.remove(item.path)
            item.deleted = True
            log.info(f&#34;Deleted file at {str(item.path)!r}&#34;)
        except PermissionError:
            if item.ask_retry and not item.skip_silent:
                if tkmsg.askretrycancel(
                    title=resource.settings.title,
                    message=(
                        f&#34;The file with the name {item.path.name!r} at the location &#34;
                        f&#34;{str(item.path)!r} cannot be deleted, because it is opened &#34;
                        &#34;by another user or process.\n\n&#34;
                        f&#34;Do you want to retry deleting this file?\n\n&#34;
                        f&#34;If you click &#39;Retry&#39; you have to make sure that the existing file &#34;
                        &#34;is not blocked by another user or process anymore.&#34;
                    ),
                ):
                    continue

            elif not item.skip_silent:
                tkmsg.showwarning(
                    title=resource.settings.title,
                    message=(
                        f&#34;The file with the name {item.path.name!r} at the location &#34;
                        f&#34;{str(item.path)!r} cannot be deleted, because it is opened &#34;
                        &#34;by another user or process.\n\n&#34;
                        &#34;Deleting this file will be skipped.&#34;
                    ),
                )

            item.skipped = True
            log.warning(
                f&#34;Skipped deleting file at {str(item.path)!r}: Not enough permission.&#34;
            )
            return</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.files.FileUtility.move_all"><code class="name flex">
<span>def <span class="ident">move_all</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Moves all files.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def move_all(self) -&gt; None:
    &#34;&#34;&#34;Moves all files.&#34;&#34;&#34;
    for item in self._move_list:
        self.move_item(item)</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.files.FileUtility.move_item"><code class="name flex">
<span>def <span class="ident">move_item</span></span>(<span>self, item: models.files.FileUtilityMoveModel) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Moves the given item from the list of move-items.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>item</code></strong> :&ensp;<code>FileUtilityDeleteModel</code></dt>
<dd>The file to move.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def move_item(self, item: FileUtilityMoveModel) -&gt; None:
    &#34;&#34;&#34;
    Moves the given item from the list of move-items.

    Args:
        item (FileUtilityDeleteModel): The file to move.
    &#34;&#34;&#34;
    # TODO: Add option to move as &#39;file (new)&#39; if cannot be moved due to permission error.
    if not item.moved and not item.skipped:
        while os.path.exists(item.target):
            if item.delete_existing:
                try:
                    os.remove(item.target)
                    log.info(f&#34;Deleted existing file at {str(item.target)!r}&#34;)
                    break
                except PermissionError:
                    if item.ask_retry:
                        if tkmsg.askretrycancel(
                            title=resource.settings.title,
                            message=(
                                f&#34;Cannot move file, because a file with the name &#34;
                                f&#34;{item.target.name!r} already exists at {str(item.target.parent)!r}, &#34;
                                &#34;but cannot be overwritten, because it is opened by another &#34;
                                &#34;user or process.\n\n&#34;
                                &#34;Do you want to retry moving file?\n\n&#34;
                                &#34;If you click &#39;Retry&#39; you have to make sure that the &#34;
                                &#34;existing file is not blocked by another user or &#34;
                                &#34;process anymore.&#34;
                            ),
                        ):
                            continue
            item.skipped = True
            log.warning(
                f&#34;Skipped moving file from {str(item.source)!r} to {str(item.target)!r}.&#34;
                &#34;\n\nThe target file already exists and cannot be deleted, because it is &#34;
                &#34;blocked by another user or process.&#34;
            )
            if item.delete_skipped:
                os.remove(item.source)
                log.info(f&#34;Deleted skipped file {str(item.source)!r}.&#34;)
            return

        shutil.move(item.source, item.target)
        item.moved = True
        log.info(f&#34;Moved file from {str(item.source)!r} to {str(item.target)!r}.&#34;)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pytia_bill_of_material.utils" href="index.html">pytia_bill_of_material.utils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pytia_bill_of_material.utils.files.FileUtility" href="#pytia_bill_of_material.utils.files.FileUtility">FileUtility</a></code></h4>
<ul class="two-column">
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.add_delete" href="#pytia_bill_of_material.utils.files.FileUtility.add_delete">add_delete</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.add_move" href="#pytia_bill_of_material.utils.files.FileUtility.add_move">add_move</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.all_deleted" href="#pytia_bill_of_material.utils.files.FileUtility.all_deleted">all_deleted</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.all_moved" href="#pytia_bill_of_material.utils.files.FileUtility.all_moved">all_moved</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.delete_all" href="#pytia_bill_of_material.utils.files.FileUtility.delete_all">delete_all</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.delete_all_exit" href="#pytia_bill_of_material.utils.files.FileUtility.delete_all_exit">delete_all_exit</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.delete_item" href="#pytia_bill_of_material.utils.files.FileUtility.delete_item">delete_item</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.delete_items" href="#pytia_bill_of_material.utils.files.FileUtility.delete_items">delete_items</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.get_random_filename" href="#pytia_bill_of_material.utils.files.FileUtility.get_random_filename">get_random_filename</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.move_all" href="#pytia_bill_of_material.utils.files.FileUtility.move_all">move_all</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.move_item" href="#pytia_bill_of_material.utils.files.FileUtility.move_item">move_item</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.files.FileUtility.move_items" href="#pytia_bill_of_material.utils.files.FileUtility.move_items">move_items</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>