<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>pytia_bill_of_material.utils.excel API documentation</title>
<meta name="description" content="Excel utility: Functions for handling Excel files." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pytia_bill_of_material.utils.excel</code></h1>
</header>
<section id="section-intro">
<p>Excel utility: Functions for handling Excel files.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
    Excel utility: Functions for handling Excel files.
&#34;&#34;&#34;

import os
import re
from pathlib import Path
from typing import Any, Dict, List, Literal

from const import EXCEL_EXE, KEEP, X000D
from exceptions import PytiaConvertError, PytiaDispatchError, PytiaNotInstalledError
from models.bom import BOM, BOMAssembly, BOMAssemblyItem
from models.paths import Paths
from openpyxl import load_workbook
from openpyxl.styles import Alignment, Font, PatternFill
from openpyxl.workbook import Workbook
from openpyxl.worksheet._read_only import ReadOnlyWorksheet
from openpyxl.worksheet.worksheet import Worksheet
from pytia.log import log
from resources import resource
from win32com.client import CDispatch, Dispatch
from win32com.client.gencache import EnsureDispatch
from win32com.server.exception import COMException

from utils.system import application_is_running


def get_excel() -&gt; CDispatch:
    &#34;&#34;&#34;
    Returns the EXCEL com object.

    Raises:
        PytiaNotInstalledError: Raised when MS Excel is not installed.
        PytiaDispatchError: Raises when the connection to the Excel com host fails.

    Returns:
        CDispatch: The Excel com object.
    &#34;&#34;&#34;
    try:
        # app = EnsureDispatch(&#34;EXCEL.Application&#34;)
        app = Dispatch(&#34;EXCEL.Application&#34;)
        return app
    except COMException as e:
        raise PytiaNotInstalledError(
            f&#34;Excel is not installed on this system: {e}&#34;
        ) from e
    except Exception as e:  # pylint: disable=broad-except
        raise PytiaDispatchError(f&#34;Failed connecting to Excel: {e}&#34;) from e


def convert_xls_to_xlsx(xls_path: Path) -&gt; Path:
    &#34;&#34;&#34;
    Converts the xls file format to the xlsx format. This is done by using the installed Excel
    application.

    Args:
        xls_path (Path): The path to the file to convert.

    Raises:
        FileNotFoundError: Raised when the input path does not exist.
        PytiaConvertError: Raised when the file cannot be converted (EXCEL save method fails).

    Returns:
        Path: The path to the converted xlsx file.
    &#34;&#34;&#34;
    log.info(&#34;Converting bill of material format from &#39;xls&#39; to &#39;xlsx&#39;.&#34;)
    xlsx_path = Path(str(xls_path) + &#34;x&#34;)

    if not os.path.isfile(xls_path):
        raise FileNotFoundError(f&#34;Cannot open xls file at {xls_path}: Not found.&#34;)

    if os.path.exists(xlsx_path):
        os.remove(xlsx_path)

    keep_running = application_is_running(EXCEL_EXE)

    excel_dispatch = get_excel()
    workbook = excel_dispatch.Workbooks.Open(str(xls_path))
    try:
        workbook.SaveAs(str(xlsx_path), FileFormat=51)  # 51: Format of xlsx extension
        log.info(f&#34;Converted bill of material to {str(xlsx_path)!r}.&#34;)
        return xlsx_path
    except Exception as e:
        raise PytiaConvertError(f&#34;Failed to convert xls to xlsx: {e}&#34;) from e
    finally:
        workbook.Close() if keep_running else excel_dispatch.Application.Quit()
        # Delete the object, otherwise the excel process remains in the task manager.
        del excel_dispatch


def get_workbook_from_xlsx(xlsx_path: Path) -&gt; Workbook:
    &#34;&#34;&#34;
    Returns a Workbook object from the xlsx file. Closes the file afterwards. Only reads the data.

    Args:
        xlsx_path (Path): The path to the xlsx file.

    Returns:
        Workbook: The workbook.
    &#34;&#34;&#34;
    workbook = load_workbook(filename=str(xlsx_path), data_only=True)
    workbook.close()
    return workbook


def get_header_positions(
    worksheet: Worksheet | ReadOnlyWorksheet, row: int, header_items: tuple
) -&gt; Dict[str, int]:
    &#34;&#34;&#34;
    Returns a dictionary of the header positions from the from CATIA exported raw bill of material.
    Maps the header positions from the bill of material to the header names.

    Example:
    The header of the raw export looks like this: `Project | Part Number | Revision`
    Then the returned dictionary looks like this: `{&#34;Project&#34;: 1, &#34;Part Number&#34;: 2, &#34;Revision&#34;: 3}`

    The index starts with `1`, so the dictionary is usable on excel columns.

    This method is purely for verifying the raw CATIA export. If everything is correct, then
    CATIA will export all later required header items on the correct position, given in the
    bom.json config file.

    Args:
        worksheet (Worksheet | ReadOnlyWorksheet): The worksheet to get the header positions from.
        row (int): The row in which to look for the header positions.
        header_items (tuple): The header names to match.

    Raises:
        KeyError: Raised if the header names do not exist in the worksheet.

    Returns:
        Dict[str, int]: The dictionary of header positions.
    &#34;&#34;&#34;
    header: dict = {}

    for i in range(1, worksheet.max_column + 1):
        header[worksheet.cell(row, i).value] = i

    # Check if CATIA exported all headers from the provided header items dict from the bom.json
    for item in header_items:
        if item not in header.keys():
            raise KeyError(
                f&#34;Header item {item!r} not found in exported bill of material.&#34;
            )

    # Check if all required header items from the bom.json are in the exported headers
    # TODO: Put this into another function, this function has too many responsibilities.
    for required_header in resource.bom.required_header_items.values:
        if required_header not in header.keys():
            raise KeyError(
                f&#34;The required header item {required_header!r} is not present in the exported &#34;
                &#34;bill of material. Please add this header to the bom.json.&#34;
            )

    log.info(&#34;Retrieved header items from excel worksheet.&#34;)
    return header


def create_header(worksheet: Worksheet, items: tuple) -&gt; None:
    &#34;&#34;&#34;
    Creates a header row in the given worksheet.

    Args:
        worksheet (Worksheet): The worksheet into which to create the header row.
        items (tuple): The header items to create.
    &#34;&#34;&#34;
    if isinstance(resource.bom.header_row, int):
        for index, item in enumerate(items):
            worksheet.cell(resource.bom.header_row + 1, index + 1).value = item
        log.info(f&#34;Created header for worksheet {worksheet.title!r}&#34;)
    else:
        log.info(f&#34;Skipped creating header for worksheet {worksheet.title!r}.&#34;)


def write_data(
    worksheet: Worksheet, header_items: tuple, data: List[BOMAssemblyItem]
) -&gt; None:
    &#34;&#34;&#34;
    Writes the properties from the given data object to the given worksheet.
    Takes care that each datum will be written to the corresponding header.

    Args:
        worksheet (Worksheet): The worksheet to add the data to.
        header_items (tuple): The header items.
        data (List[BOMAssemblyItem]): The actual data.
    &#34;&#34;&#34;
    for ri, rv in enumerate(data):
        for ci, cv in enumerate(header_items):
            worksheet.cell(
                row=ri + resource.bom.data_row + 1, column=ci + 1
            ).value = rv.properties[cv]
    log.info(f&#34;Wrote all data to worksheet {worksheet.title!r}.&#34;)


def row_is_empty(worksheet: Worksheet | ReadOnlyWorksheet, row: int) -&gt; bool:
    &#34;&#34;&#34;Returns wether the given row is empty or not.&#34;&#34;&#34;
    return all(
        [
            worksheet.cell(row, i).value is None
            for i in range(1, worksheet.max_column + 1)
        ]
    )


def style_worksheet(worksheet: Worksheet) -&gt; None:
    &#34;&#34;&#34;Styles the worksheet as stated in the bom.json config file.&#34;&#34;&#34;
    for column_cells in worksheet.columns:
        # Set format, font and size
        for index, cell in enumerate(column_cells):
            if index &gt; resource.bom.data_row - 1:
                color = (
                    resource.bom.data_color_1
                    if index % 2 == 0
                    else resource.bom.data_color_2
                )
                bg_color = (
                    resource.bom.data_bg_color_1
                    if index % 2 == 0
                    else resource.bom.data_bg_color_2
                )
                cell.fill = PatternFill(
                    start_color=bg_color, end_color=bg_color, fill_type=&#34;solid&#34;
                )
            else:
                color = None
            cell.number_format = &#34;@&#34;
            cell.font = Font(
                name=resource.bom.font, size=resource.bom.size, color=color
            )
            cell.alignment = Alignment(horizontal=&#34;left&#34;, vertical=&#34;center&#34;)

        # Set font and height for the header row
        if isinstance(resource.bom.header_row, int):
            worksheet.row_dimensions[resource.bom.header_row + 1].height = 20
            column_cells[resource.bom.header_row].font = Font(
                name=resource.bom.font,
                size=resource.bom.size,
                bold=True,
                color=resource.bom.header_color,
            )
            column_cells[resource.bom.header_row].fill = PatternFill(
                start_color=resource.bom.header_bg_color,
                end_color=resource.bom.header_bg_color,
                fill_type=&#34;solid&#34;,
            )
            column_cells[resource.bom.header_row].alignment = Alignment(
                horizontal=&#34;center&#34;, vertical=&#34;center&#34;
            )

        # Set cell width
        length = max(len(str(cell.value)) * 1.1 for cell in column_cells)
        worksheet.column_dimensions[column_cells[0].column_letter].width = (
            length if length &gt; 2 else 2
        )

    log.info(f&#34;Styled worksheet {worksheet.title!r}.&#34;)


def retrieve_bom_from_catia_export(
    worksheet: Worksheet | ReadOnlyWorksheet,
    paths: Paths,
    language: Literal[&#34;en&#34;, &#34;de&#34;],
    overwrite_project: str = KEEP,
) -&gt; BOM:
    &#34;&#34;&#34;
    Extracts all bill of materials and the summary from the CATIA export EXCEL file.
    Some keyword names depend on the language of the CATIA UI. It is therefor necessary to
    check the language first, the the keywords can be matched.

    Args:
        worksheet (Worksheet | ReadOnlyWorksheet): The worksheet from which to extract the data.
        paths (Paths): The paths from all CATIA partnumbers in the BOM.
        language (Literal[en | de]): The UI language.
        overwrite_project (str): The project number that will be written into the BOM object. \
            If set to `KEEP` all existing project number will be left, otherwise the provided 
            string will be written into the BOM object.

    Raises:
        KeyError: Raised when the exported EXCEL file has no partnumber column.
        KeyError: Raised when there is a partnumber in the BOM that is not in the paths list.

    Returns:
        BOM: The bill of material object.
    &#34;&#34;&#34;
    bom = BOM()
    assembly: BOMAssembly | None = None
    header_positions: dict = {}
    data_row = 0
    is_summary = False

    log.info(&#34;Retrieving bill of material from exported Excel file.&#34;)
    header_items = tuple(item for item in resource.bom.header_items)

    keywords = resource.keywords.en if language == &#34;en&#34; else resource.keywords.de

    for ri in range(1, worksheet.max_row + 1):
        _bom_or_summary = str(worksheet.cell(ri, 1).value).split(&#34;: &#34;)[0]
        _name = str(worksheet.cell(ri, 1).value).split(&#34;: &#34;)[-1]

        if row_is_empty(worksheet, ri) and assembly is not None and not is_summary:
            bom.assemblies.append(assembly)
            assembly = None

        elif keywords.bom in _bom_or_summary:
            assembly = BOMAssembly(partnumber=_name, path=paths.items[_name])
            header_positions = get_header_positions(
                worksheet=worksheet, row=ri + 1, header_items=header_items
            )
            data_row = ri + 2
            log.info(f&#34;Processing BOM of element {_name!r}.&#34;)

        elif keywords.summary in _bom_or_summary:
            is_summary = True
            assembly = BOMAssembly(partnumber=_name, path=paths.items[_name])
            header_positions = get_header_positions(
                worksheet=worksheet, row=ri + 4, header_items=header_items
            )
            data_row = ri + 5
            log.info(f&#34;Processing BOM summary.&#34;)

        if assembly is not None and ri &gt;= data_row:
            row_data: dict = {}
            for position in header_positions:
                cell_value = worksheet.cell(ri, header_positions[position]).value

                if isinstance(cell_value, str) and X000D in cell_value:
                    # This is a result of legacy CATIA macros. This isn&#39;t needed if all
                    # parts and products are setup with the pytia-property-manager.
                    cell_value = cell_value.replace(&#34;_x000D_\n&#34;, &#34;\n&#34;)

                if isinstance(cell_value, str) and re.match(r&#34;\s+&#34;, cell_value):
                    # CATIA exports empty cells as chr(13). This results in a space
                    # string &#34; &#34; instead of a truly empty cell. This is fixed by checking
                    # for only-whitespace characters and replacing them with None.
                    cell_value = None

                cell_value = overwrite_project_number(
                    header_position=position,
                    cell_value=cell_value,
                    overwrite_number=overwrite_project,
                )

                cell_value = translate_username(
                    header_position=position, cell_value=cell_value
                )

                print(type(cell_value))

                row_data[position] = cell_value

            if is_summary:
                bom.summary = assembly

            if not keywords.partnumber in row_data:
                raise KeyError(
                    f&#34;Cannot find keyword {keywords.partnumber!r} in exported Excel file. &#34;
                    &#34;Are your language settings correct? Or is the $partnumber keyword not set &#34;
                    &#34;in the bom.json&#39;s header_items?&#34;
                )

            if row_data[keywords.partnumber] is None:
                raise ValueError(&#34;The value for the partnumber is empty.&#34;)

            if row_data[keywords.partnumber] not in paths.items:
                raise KeyError(f&#34;Cannot find path for BOM item {_name!r}.&#34;)

            assembly_item = BOMAssemblyItem(
                partnumber=row_data[keywords.partnumber],
                properties=row_data,
                path=paths.items[row_data[keywords.partnumber]],
            )
            assembly.items.append(assembly_item)
    return bom


def overwrite_project_number(
    header_position: str, cell_value: str | Any | None, overwrite_number: str
) -&gt; str | Any | None:
    &#34;&#34;&#34;
    Returns the overwritten project number if the header position is the project and if the user
    selected the project number to be overwritten.
    Otherwise returns the given cell_value without changes.

    Args:
        header_position (str): The header position (the name of the header).
        cell_value (str | Any | None): The cell value to be overwritten.
        overwrite_number (str): The project number that will be written.

    Returns:
        str | Any | None: The cell value or the overwritten project number.
    &#34;&#34;&#34;
    if (
        header_position == resource.bom.required_header_items.project
        and overwrite_number != KEEP
    ):
        return overwrite_number
    return cell_value


def translate_username(
    header_position: str, cell_value: str | Any | None
) -&gt; str | Any | None:
    &#34;&#34;&#34;
    Returns the translated username if the header position is creator or modifier.
    Otherwise returns the given cell_value without changes.

    Args:
        header_position (str): The header position (the name of the header).
        cell_value (str | Any | None): The cell value to be translated.

    Returns:
        str | Any | None: The translated username or the cell value.
    &#34;&#34;&#34;
    if (
        resource.settings.export.apply_username_in_bom
        and (
            header_position == resource.props.creator
            or header_position == resource.props.modifier
        )
        and resource.user_exists(str(cell_value))
    ):
        return resource.get_user_by_logon(str(cell_value)).name
    return cell_value</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="pytia_bill_of_material.utils.excel.convert_xls_to_xlsx"><code class="name flex">
<span>def <span class="ident">convert_xls_to_xlsx</span></span>(<span>xls_path: pathlib.Path) ‑> pathlib.Path</span>
</code></dt>
<dd>
<div class="desc"><p>Converts the xls file format to the xlsx format. This is done by using the installed Excel
application.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>xls_path</code></strong> :&ensp;<code>Path</code></dt>
<dd>The path to the file to convert.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>FileNotFoundError</code></dt>
<dd>Raised when the input path does not exist.</dd>
<dt><code>PytiaConvertError</code></dt>
<dd>Raised when the file cannot be converted (EXCEL save method fails).</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Path</code></dt>
<dd>The path to the converted xlsx file.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def convert_xls_to_xlsx(xls_path: Path) -&gt; Path:
    &#34;&#34;&#34;
    Converts the xls file format to the xlsx format. This is done by using the installed Excel
    application.

    Args:
        xls_path (Path): The path to the file to convert.

    Raises:
        FileNotFoundError: Raised when the input path does not exist.
        PytiaConvertError: Raised when the file cannot be converted (EXCEL save method fails).

    Returns:
        Path: The path to the converted xlsx file.
    &#34;&#34;&#34;
    log.info(&#34;Converting bill of material format from &#39;xls&#39; to &#39;xlsx&#39;.&#34;)
    xlsx_path = Path(str(xls_path) + &#34;x&#34;)

    if not os.path.isfile(xls_path):
        raise FileNotFoundError(f&#34;Cannot open xls file at {xls_path}: Not found.&#34;)

    if os.path.exists(xlsx_path):
        os.remove(xlsx_path)

    keep_running = application_is_running(EXCEL_EXE)

    excel_dispatch = get_excel()
    workbook = excel_dispatch.Workbooks.Open(str(xls_path))
    try:
        workbook.SaveAs(str(xlsx_path), FileFormat=51)  # 51: Format of xlsx extension
        log.info(f&#34;Converted bill of material to {str(xlsx_path)!r}.&#34;)
        return xlsx_path
    except Exception as e:
        raise PytiaConvertError(f&#34;Failed to convert xls to xlsx: {e}&#34;) from e
    finally:
        workbook.Close() if keep_running else excel_dispatch.Application.Quit()
        # Delete the object, otherwise the excel process remains in the task manager.
        del excel_dispatch</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.excel.create_header"><code class="name flex">
<span>def <span class="ident">create_header</span></span>(<span>worksheet: openpyxl.worksheet.worksheet.Worksheet, items: tuple) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Creates a header row in the given worksheet.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>worksheet</code></strong> :&ensp;<code>Worksheet</code></dt>
<dd>The worksheet into which to create the header row.</dd>
<dt><strong><code>items</code></strong> :&ensp;<code>tuple</code></dt>
<dd>The header items to create.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_header(worksheet: Worksheet, items: tuple) -&gt; None:
    &#34;&#34;&#34;
    Creates a header row in the given worksheet.

    Args:
        worksheet (Worksheet): The worksheet into which to create the header row.
        items (tuple): The header items to create.
    &#34;&#34;&#34;
    if isinstance(resource.bom.header_row, int):
        for index, item in enumerate(items):
            worksheet.cell(resource.bom.header_row + 1, index + 1).value = item
        log.info(f&#34;Created header for worksheet {worksheet.title!r}&#34;)
    else:
        log.info(f&#34;Skipped creating header for worksheet {worksheet.title!r}.&#34;)</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.excel.get_excel"><code class="name flex">
<span>def <span class="ident">get_excel</span></span>(<span>) ‑> win32com.client.CDispatch</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the EXCEL com object.</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>PytiaNotInstalledError</code></dt>
<dd>Raised when MS Excel is not installed.</dd>
<dt><code>PytiaDispatchError</code></dt>
<dd>Raises when the connection to the Excel com host fails.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>CDispatch</code></dt>
<dd>The Excel com object.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_excel() -&gt; CDispatch:
    &#34;&#34;&#34;
    Returns the EXCEL com object.

    Raises:
        PytiaNotInstalledError: Raised when MS Excel is not installed.
        PytiaDispatchError: Raises when the connection to the Excel com host fails.

    Returns:
        CDispatch: The Excel com object.
    &#34;&#34;&#34;
    try:
        # app = EnsureDispatch(&#34;EXCEL.Application&#34;)
        app = Dispatch(&#34;EXCEL.Application&#34;)
        return app
    except COMException as e:
        raise PytiaNotInstalledError(
            f&#34;Excel is not installed on this system: {e}&#34;
        ) from e
    except Exception as e:  # pylint: disable=broad-except
        raise PytiaDispatchError(f&#34;Failed connecting to Excel: {e}&#34;) from e</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.excel.get_header_positions"><code class="name flex">
<span>def <span class="ident">get_header_positions</span></span>(<span>worksheet: openpyxl.worksheet.worksheet.Worksheet | openpyxl.worksheet._read_only.ReadOnlyWorksheet, row: int, header_items: tuple) ‑> Dict[str, int]</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a dictionary of the header positions from the from CATIA exported raw bill of material.
Maps the header positions from the bill of material to the header names.</p>
<p>Example:
The header of the raw export looks like this: <code>Project | Part Number | Revision</code>
Then the returned dictionary looks like this: <code>{"Project": 1, "Part Number": 2, "Revision": 3}</code></p>
<p>The index starts with <code>1</code>, so the dictionary is usable on excel columns.</p>
<p>This method is purely for verifying the raw CATIA export. If everything is correct, then
CATIA will export all later required header items on the correct position, given in the
bom.json config file.</p>
<h2 id="args">Args</h2>
<dl>
<dt>worksheet (Worksheet | ReadOnlyWorksheet): The worksheet to get the header positions from.</dt>
<dt><strong><code>row</code></strong> :&ensp;<code>int</code></dt>
<dd>The row in which to look for the header positions.</dd>
<dt><strong><code>header_items</code></strong> :&ensp;<code>tuple</code></dt>
<dd>The header names to match.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>KeyError</code></dt>
<dd>Raised if the header names do not exist in the worksheet.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Dict[str, int]</code></dt>
<dd>The dictionary of header positions.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_header_positions(
    worksheet: Worksheet | ReadOnlyWorksheet, row: int, header_items: tuple
) -&gt; Dict[str, int]:
    &#34;&#34;&#34;
    Returns a dictionary of the header positions from the from CATIA exported raw bill of material.
    Maps the header positions from the bill of material to the header names.

    Example:
    The header of the raw export looks like this: `Project | Part Number | Revision`
    Then the returned dictionary looks like this: `{&#34;Project&#34;: 1, &#34;Part Number&#34;: 2, &#34;Revision&#34;: 3}`

    The index starts with `1`, so the dictionary is usable on excel columns.

    This method is purely for verifying the raw CATIA export. If everything is correct, then
    CATIA will export all later required header items on the correct position, given in the
    bom.json config file.

    Args:
        worksheet (Worksheet | ReadOnlyWorksheet): The worksheet to get the header positions from.
        row (int): The row in which to look for the header positions.
        header_items (tuple): The header names to match.

    Raises:
        KeyError: Raised if the header names do not exist in the worksheet.

    Returns:
        Dict[str, int]: The dictionary of header positions.
    &#34;&#34;&#34;
    header: dict = {}

    for i in range(1, worksheet.max_column + 1):
        header[worksheet.cell(row, i).value] = i

    # Check if CATIA exported all headers from the provided header items dict from the bom.json
    for item in header_items:
        if item not in header.keys():
            raise KeyError(
                f&#34;Header item {item!r} not found in exported bill of material.&#34;
            )

    # Check if all required header items from the bom.json are in the exported headers
    # TODO: Put this into another function, this function has too many responsibilities.
    for required_header in resource.bom.required_header_items.values:
        if required_header not in header.keys():
            raise KeyError(
                f&#34;The required header item {required_header!r} is not present in the exported &#34;
                &#34;bill of material. Please add this header to the bom.json.&#34;
            )

    log.info(&#34;Retrieved header items from excel worksheet.&#34;)
    return header</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.excel.get_workbook_from_xlsx"><code class="name flex">
<span>def <span class="ident">get_workbook_from_xlsx</span></span>(<span>xlsx_path: pathlib.Path) ‑> openpyxl.workbook.workbook.Workbook</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a Workbook object from the xlsx file. Closes the file afterwards. Only reads the data.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>xlsx_path</code></strong> :&ensp;<code>Path</code></dt>
<dd>The path to the xlsx file.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Workbook</code></dt>
<dd>The workbook.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_workbook_from_xlsx(xlsx_path: Path) -&gt; Workbook:
    &#34;&#34;&#34;
    Returns a Workbook object from the xlsx file. Closes the file afterwards. Only reads the data.

    Args:
        xlsx_path (Path): The path to the xlsx file.

    Returns:
        Workbook: The workbook.
    &#34;&#34;&#34;
    workbook = load_workbook(filename=str(xlsx_path), data_only=True)
    workbook.close()
    return workbook</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.excel.overwrite_project_number"><code class="name flex">
<span>def <span class="ident">overwrite_project_number</span></span>(<span>header_position: str, cell_value: Union[str, Any, ForwardRef(None)], overwrite_number: str) ‑> Union[str, Any, ForwardRef(None)]</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the overwritten project number if the header position is the project and if the user
selected the project number to be overwritten.
Otherwise returns the given cell_value without changes.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>header_position</code></strong> :&ensp;<code>str</code></dt>
<dd>The header position (the name of the header).</dd>
<dt>cell_value (str | Any | None): The cell value to be overwritten.</dt>
<dt><strong><code>overwrite_number</code></strong> :&ensp;<code>str</code></dt>
<dd>The project number that will be written.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>str | Any | None: The cell value or the overwritten project number.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def overwrite_project_number(
    header_position: str, cell_value: str | Any | None, overwrite_number: str
) -&gt; str | Any | None:
    &#34;&#34;&#34;
    Returns the overwritten project number if the header position is the project and if the user
    selected the project number to be overwritten.
    Otherwise returns the given cell_value without changes.

    Args:
        header_position (str): The header position (the name of the header).
        cell_value (str | Any | None): The cell value to be overwritten.
        overwrite_number (str): The project number that will be written.

    Returns:
        str | Any | None: The cell value or the overwritten project number.
    &#34;&#34;&#34;
    if (
        header_position == resource.bom.required_header_items.project
        and overwrite_number != KEEP
    ):
        return overwrite_number
    return cell_value</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.excel.retrieve_bom_from_catia_export"><code class="name flex">
<span>def <span class="ident">retrieve_bom_from_catia_export</span></span>(<span>worksheet: openpyxl.worksheet.worksheet.Worksheet | openpyxl.worksheet._read_only.ReadOnlyWorksheet, paths: models.paths.Paths, language: Literal['en', 'de'], overwrite_project: str = 'Keep') ‑> models.bom.BOM</span>
</code></dt>
<dd>
<div class="desc"><p>Extracts all bill of materials and the summary from the CATIA export EXCEL file.
Some keyword names depend on the language of the CATIA UI. It is therefor necessary to
check the language first, the the keywords can be matched.</p>
<h2 id="args">Args</h2>
<dl>
<dt>worksheet (Worksheet | ReadOnlyWorksheet): The worksheet from which to extract the data.</dt>
<dt><strong><code>paths</code></strong> :&ensp;<code>Paths</code></dt>
<dd>The paths from all CATIA partnumbers in the BOM.</dd>
<dt>language (Literal[en | de]): The UI language.</dt>
<dt><strong><code>overwrite_project</code></strong> :&ensp;<code>str</code></dt>
<dd>The project number that will be written into the BOM object.
If set to <code>KEEP</code> all existing project number will be left, otherwise the provided
string will be written into the BOM object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>KeyError</code></dt>
<dd>Raised when the exported EXCEL file has no partnumber column.</dd>
<dt><code>KeyError</code></dt>
<dd>Raised when there is a partnumber in the BOM that is not in the paths list.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>BOM</code></dt>
<dd>The bill of material object.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def retrieve_bom_from_catia_export(
    worksheet: Worksheet | ReadOnlyWorksheet,
    paths: Paths,
    language: Literal[&#34;en&#34;, &#34;de&#34;],
    overwrite_project: str = KEEP,
) -&gt; BOM:
    &#34;&#34;&#34;
    Extracts all bill of materials and the summary from the CATIA export EXCEL file.
    Some keyword names depend on the language of the CATIA UI. It is therefor necessary to
    check the language first, the the keywords can be matched.

    Args:
        worksheet (Worksheet | ReadOnlyWorksheet): The worksheet from which to extract the data.
        paths (Paths): The paths from all CATIA partnumbers in the BOM.
        language (Literal[en | de]): The UI language.
        overwrite_project (str): The project number that will be written into the BOM object. \
            If set to `KEEP` all existing project number will be left, otherwise the provided 
            string will be written into the BOM object.

    Raises:
        KeyError: Raised when the exported EXCEL file has no partnumber column.
        KeyError: Raised when there is a partnumber in the BOM that is not in the paths list.

    Returns:
        BOM: The bill of material object.
    &#34;&#34;&#34;
    bom = BOM()
    assembly: BOMAssembly | None = None
    header_positions: dict = {}
    data_row = 0
    is_summary = False

    log.info(&#34;Retrieving bill of material from exported Excel file.&#34;)
    header_items = tuple(item for item in resource.bom.header_items)

    keywords = resource.keywords.en if language == &#34;en&#34; else resource.keywords.de

    for ri in range(1, worksheet.max_row + 1):
        _bom_or_summary = str(worksheet.cell(ri, 1).value).split(&#34;: &#34;)[0]
        _name = str(worksheet.cell(ri, 1).value).split(&#34;: &#34;)[-1]

        if row_is_empty(worksheet, ri) and assembly is not None and not is_summary:
            bom.assemblies.append(assembly)
            assembly = None

        elif keywords.bom in _bom_or_summary:
            assembly = BOMAssembly(partnumber=_name, path=paths.items[_name])
            header_positions = get_header_positions(
                worksheet=worksheet, row=ri + 1, header_items=header_items
            )
            data_row = ri + 2
            log.info(f&#34;Processing BOM of element {_name!r}.&#34;)

        elif keywords.summary in _bom_or_summary:
            is_summary = True
            assembly = BOMAssembly(partnumber=_name, path=paths.items[_name])
            header_positions = get_header_positions(
                worksheet=worksheet, row=ri + 4, header_items=header_items
            )
            data_row = ri + 5
            log.info(f&#34;Processing BOM summary.&#34;)

        if assembly is not None and ri &gt;= data_row:
            row_data: dict = {}
            for position in header_positions:
                cell_value = worksheet.cell(ri, header_positions[position]).value

                if isinstance(cell_value, str) and X000D in cell_value:
                    # This is a result of legacy CATIA macros. This isn&#39;t needed if all
                    # parts and products are setup with the pytia-property-manager.
                    cell_value = cell_value.replace(&#34;_x000D_\n&#34;, &#34;\n&#34;)

                if isinstance(cell_value, str) and re.match(r&#34;\s+&#34;, cell_value):
                    # CATIA exports empty cells as chr(13). This results in a space
                    # string &#34; &#34; instead of a truly empty cell. This is fixed by checking
                    # for only-whitespace characters and replacing them with None.
                    cell_value = None

                cell_value = overwrite_project_number(
                    header_position=position,
                    cell_value=cell_value,
                    overwrite_number=overwrite_project,
                )

                cell_value = translate_username(
                    header_position=position, cell_value=cell_value
                )

                print(type(cell_value))

                row_data[position] = cell_value

            if is_summary:
                bom.summary = assembly

            if not keywords.partnumber in row_data:
                raise KeyError(
                    f&#34;Cannot find keyword {keywords.partnumber!r} in exported Excel file. &#34;
                    &#34;Are your language settings correct? Or is the $partnumber keyword not set &#34;
                    &#34;in the bom.json&#39;s header_items?&#34;
                )

            if row_data[keywords.partnumber] is None:
                raise ValueError(&#34;The value for the partnumber is empty.&#34;)

            if row_data[keywords.partnumber] not in paths.items:
                raise KeyError(f&#34;Cannot find path for BOM item {_name!r}.&#34;)

            assembly_item = BOMAssemblyItem(
                partnumber=row_data[keywords.partnumber],
                properties=row_data,
                path=paths.items[row_data[keywords.partnumber]],
            )
            assembly.items.append(assembly_item)
    return bom</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.excel.row_is_empty"><code class="name flex">
<span>def <span class="ident">row_is_empty</span></span>(<span>worksheet: openpyxl.worksheet.worksheet.Worksheet | openpyxl.worksheet._read_only.ReadOnlyWorksheet, row: int) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>Returns wether the given row is empty or not.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def row_is_empty(worksheet: Worksheet | ReadOnlyWorksheet, row: int) -&gt; bool:
    &#34;&#34;&#34;Returns wether the given row is empty or not.&#34;&#34;&#34;
    return all(
        [
            worksheet.cell(row, i).value is None
            for i in range(1, worksheet.max_column + 1)
        ]
    )</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.excel.style_worksheet"><code class="name flex">
<span>def <span class="ident">style_worksheet</span></span>(<span>worksheet: openpyxl.worksheet.worksheet.Worksheet) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Styles the worksheet as stated in the bom.json config file.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def style_worksheet(worksheet: Worksheet) -&gt; None:
    &#34;&#34;&#34;Styles the worksheet as stated in the bom.json config file.&#34;&#34;&#34;
    for column_cells in worksheet.columns:
        # Set format, font and size
        for index, cell in enumerate(column_cells):
            if index &gt; resource.bom.data_row - 1:
                color = (
                    resource.bom.data_color_1
                    if index % 2 == 0
                    else resource.bom.data_color_2
                )
                bg_color = (
                    resource.bom.data_bg_color_1
                    if index % 2 == 0
                    else resource.bom.data_bg_color_2
                )
                cell.fill = PatternFill(
                    start_color=bg_color, end_color=bg_color, fill_type=&#34;solid&#34;
                )
            else:
                color = None
            cell.number_format = &#34;@&#34;
            cell.font = Font(
                name=resource.bom.font, size=resource.bom.size, color=color
            )
            cell.alignment = Alignment(horizontal=&#34;left&#34;, vertical=&#34;center&#34;)

        # Set font and height for the header row
        if isinstance(resource.bom.header_row, int):
            worksheet.row_dimensions[resource.bom.header_row + 1].height = 20
            column_cells[resource.bom.header_row].font = Font(
                name=resource.bom.font,
                size=resource.bom.size,
                bold=True,
                color=resource.bom.header_color,
            )
            column_cells[resource.bom.header_row].fill = PatternFill(
                start_color=resource.bom.header_bg_color,
                end_color=resource.bom.header_bg_color,
                fill_type=&#34;solid&#34;,
            )
            column_cells[resource.bom.header_row].alignment = Alignment(
                horizontal=&#34;center&#34;, vertical=&#34;center&#34;
            )

        # Set cell width
        length = max(len(str(cell.value)) * 1.1 for cell in column_cells)
        worksheet.column_dimensions[column_cells[0].column_letter].width = (
            length if length &gt; 2 else 2
        )

    log.info(f&#34;Styled worksheet {worksheet.title!r}.&#34;)</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.excel.translate_username"><code class="name flex">
<span>def <span class="ident">translate_username</span></span>(<span>header_position: str, cell_value: Union[str, Any, ForwardRef(None)]) ‑> Union[str, Any, ForwardRef(None)]</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the translated username if the header position is creator or modifier.
Otherwise returns the given cell_value without changes.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>header_position</code></strong> :&ensp;<code>str</code></dt>
<dd>The header position (the name of the header).</dd>
</dl>
<p>cell_value (str | Any | None): The cell value to be translated.</p>
<h2 id="returns">Returns</h2>
<p>str | Any | None: The translated username or the cell value.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def translate_username(
    header_position: str, cell_value: str | Any | None
) -&gt; str | Any | None:
    &#34;&#34;&#34;
    Returns the translated username if the header position is creator or modifier.
    Otherwise returns the given cell_value without changes.

    Args:
        header_position (str): The header position (the name of the header).
        cell_value (str | Any | None): The cell value to be translated.

    Returns:
        str | Any | None: The translated username or the cell value.
    &#34;&#34;&#34;
    if (
        resource.settings.export.apply_username_in_bom
        and (
            header_position == resource.props.creator
            or header_position == resource.props.modifier
        )
        and resource.user_exists(str(cell_value))
    ):
        return resource.get_user_by_logon(str(cell_value)).name
    return cell_value</code></pre>
</details>
</dd>
<dt id="pytia_bill_of_material.utils.excel.write_data"><code class="name flex">
<span>def <span class="ident">write_data</span></span>(<span>worksheet: openpyxl.worksheet.worksheet.Worksheet, header_items: tuple, data: List[models.bom.BOMAssemblyItem]) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Writes the properties from the given data object to the given worksheet.
Takes care that each datum will be written to the corresponding header.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>worksheet</code></strong> :&ensp;<code>Worksheet</code></dt>
<dd>The worksheet to add the data to.</dd>
<dt><strong><code>header_items</code></strong> :&ensp;<code>tuple</code></dt>
<dd>The header items.</dd>
<dt><strong><code>data</code></strong> :&ensp;<code>List[BOMAssemblyItem]</code></dt>
<dd>The actual data.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def write_data(
    worksheet: Worksheet, header_items: tuple, data: List[BOMAssemblyItem]
) -&gt; None:
    &#34;&#34;&#34;
    Writes the properties from the given data object to the given worksheet.
    Takes care that each datum will be written to the corresponding header.

    Args:
        worksheet (Worksheet): The worksheet to add the data to.
        header_items (tuple): The header items.
        data (List[BOMAssemblyItem]): The actual data.
    &#34;&#34;&#34;
    for ri, rv in enumerate(data):
        for ci, cv in enumerate(header_items):
            worksheet.cell(
                row=ri + resource.bom.data_row + 1, column=ci + 1
            ).value = rv.properties[cv]
    log.info(f&#34;Wrote all data to worksheet {worksheet.title!r}.&#34;)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pytia_bill_of_material.utils" href="index.html">pytia_bill_of_material.utils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="pytia_bill_of_material.utils.excel.convert_xls_to_xlsx" href="#pytia_bill_of_material.utils.excel.convert_xls_to_xlsx">convert_xls_to_xlsx</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.excel.create_header" href="#pytia_bill_of_material.utils.excel.create_header">create_header</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.excel.get_excel" href="#pytia_bill_of_material.utils.excel.get_excel">get_excel</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.excel.get_header_positions" href="#pytia_bill_of_material.utils.excel.get_header_positions">get_header_positions</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.excel.get_workbook_from_xlsx" href="#pytia_bill_of_material.utils.excel.get_workbook_from_xlsx">get_workbook_from_xlsx</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.excel.overwrite_project_number" href="#pytia_bill_of_material.utils.excel.overwrite_project_number">overwrite_project_number</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.excel.retrieve_bom_from_catia_export" href="#pytia_bill_of_material.utils.excel.retrieve_bom_from_catia_export">retrieve_bom_from_catia_export</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.excel.row_is_empty" href="#pytia_bill_of_material.utils.excel.row_is_empty">row_is_empty</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.excel.style_worksheet" href="#pytia_bill_of_material.utils.excel.style_worksheet">style_worksheet</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.excel.translate_username" href="#pytia_bill_of_material.utils.excel.translate_username">translate_username</a></code></li>
<li><code><a title="pytia_bill_of_material.utils.excel.write_data" href="#pytia_bill_of_material.utils.excel.write_data">write_data</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>